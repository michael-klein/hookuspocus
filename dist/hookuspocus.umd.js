!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.hookuspocus={})}(this,function(n){var e=window.___hookusPocusRunMap||new(WeakMap||Map);window.___hookusPocusRunMap=e;var t=e.h||[];e.h=t;var r=e.d||new(WeakMap||Map);e.d=r;var o=function(n){return function o(){var u=t[e.stackIndex][0];e.hookIndex++;var a=t[e.stackIndex][e.hookIndex]||(t[e.stackIndex][e.hookIndex]=[{context:u,hook:n}]);return(r.get(o)||n).apply({},a.concat(Array.from(arguments)))}},u=function(n,r){var o=t[e.stackIndex].map(function(n){if(n[0]&&n[0][r]){var e=n[0][r]();return n[0][r]=0,e}}).filter(function(n){return n instanceof Promise});if(o.length>0){var u=Promise.all(o);e.set(n,e.has(n)?e.get(n).then(u):u)}},a=function(n,t){if(e.has(n)){var r=e.get(n).then(t);return e.set(n,r),r}return t()},f=function(){var n,o=Array.from(arguments);return o[0].pop&&(n=o.shift()),function(n,o,f,c){if(!0!==o)return a(n,function(){return e.hookIndex=0,e.stackIndex=t.push(r.get(n)||[n])-1,r.set(n,t[e.stackIndex]),u(n,"before"),a(n,function(){var r=f.apply(f,c);return u(n,"after"),a(n,function(){return t.pop(),e.delete(n),r})})});e.set(n,u(n,"cleanUp")),r.delete(n)}("boolean"==typeof o[1]?o[0]:o[1]||o[0],!0===o[1]||o[2],o[0],n)},c=o(function(n,e,t,r){return n.s=void 0!==n.s?n.s:r?r(t):t,[n.s,function(t){return n.s=e(n.s,t),n.s}]}),i=function(n,e){r.set(n,e)},s=o(function(n,e,t){n.v&&(!t||t.length===n.v.length&&t.every(function(e){return~n.v.indexOf(e)}))||(n.v=t,n.cleanUp&&n.cleanUp(),n.after=function(){var t=e();return t instanceof Promise?t=t.then(function(e){return n.cleanUp=e}):n.cleanUp=t,t})});n.on=i,n.onStateChanged=function(n){return i(c,function(e,t,r,o){var u=e.hook(e,t,r,o),a=u[0],f=u[1];return[a,function(t){var r=f(t);return a!==r&&n(e.context),r}]})},n.hookus=o,n.pocus=f,n.useLayoutEffect=s,n.useEffect=function(n,e){s(function(){return new Promise(function(e){return requestAnimationFrame(function(t){return e(n())})})},e)},n.useReducer=c,n.useState=function(n){var e=c(function(n,e){return e.value},n),t=e[1];return[e[0],function(n){return t({value:n})}]},n.fidibus=function(n,e){var t=function(){var t=Array.from(arguments);return t.length>0?f(t,n,e):f(n,e)};return t.cleanUp=function(){f(n,e,!0)},t}});
//# sourceMappingURL=hookuspocus.umd.js.map
